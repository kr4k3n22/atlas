{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///home/atlas/atlas-hitl-ui/src/lib/userSettings.ts"],"sourcesContent":["export type ThemeMode = \"system\" | \"light\" | \"dark\";\nexport type InboxTab = \"PENDING\" | \"APPROVED\" | \"REJECTED\" | \"ALL\";\nexport type RiskFilter = \"ALL\" | \"ROUTINE\" | \"ESCALATE\" | \"BLOCK\";\nexport type PreviewBehavior = \"open_on_click\" | \"auto_on_select\";\nexport type PreviewPosition = \"right_rail\" | \"modal_drawer\";\nexport type NoteRequirement = \"off\" | \"block_only\" | \"high_only\" | \"block_or_high\";\nexport type AutoRefresh = \"off\" | \"30s\" | \"60s\";\n\nexport type UserSettings = {\n  theme: ThemeMode;\n  keyboardShortcuts: boolean;\n\n  defaultInboxTab: InboxTab;\n  defaultRiskFilter: RiskFilter;\n\n  previewBehavior: PreviewBehavior;\n  previewPosition: PreviewPosition;\n\n  decisionRequiresNote: NoteRequirement;\n  highRiskThreshold: number; // used when decisionRequiresNote involves high risk\n\n  autoRefresh: AutoRefresh;\n};\n\nexport const SETTINGS_KEY = \"atlas_user_settings_v1\";\n\nexport const defaultSettings: UserSettings = {\n  theme: \"system\",\n  keyboardShortcuts: true,\n\n  defaultInboxTab: \"PENDING\",\n  defaultRiskFilter: \"ALL\",\n\n  previewBehavior: \"open_on_click\",\n  previewPosition: \"right_rail\",\n\n  decisionRequiresNote: \"off\",\n  highRiskThreshold: 80,\n\n  autoRefresh: \"off\",\n};\n\nexport function loadSettings(): UserSettings {\n  if (typeof window === \"undefined\") return defaultSettings;\n\n  const raw = window.localStorage.getItem(SETTINGS_KEY);\n  if (!raw) return defaultSettings;\n\n  try {\n    const parsed = JSON.parse(raw) as Partial<UserSettings>;\n    return {\n      ...defaultSettings,\n      ...parsed,\n      // safety: keep threshold sane\n      highRiskThreshold:\n        typeof parsed.highRiskThreshold === \"number\"\n          ? Math.min(100, Math.max(0, parsed.highRiskThreshold))\n          : defaultSettings.highRiskThreshold,\n    };\n  } catch {\n    return defaultSettings;\n  }\n}\n\nexport function saveSettings(s: UserSettings) {\n  if (typeof window === \"undefined\") return;\n  window.localStorage.setItem(SETTINGS_KEY, JSON.stringify(s));\n  window.dispatchEvent(new CustomEvent(\"atlas_settings_change\"));\n}\n\nexport function onSettingsChange(handler: () => void) {\n  if (typeof window === \"undefined\") return () => {};\n  const fn = () => handler();\n  window.addEventListener(\"atlas_settings_change\", fn);\n  window.addEventListener(\"storage\", fn);\n  return () => {\n    window.removeEventListener(\"atlas_settings_change\", fn);\n    window.removeEventListener(\"storage\", fn);\n  };\n}\n\nexport function applyTheme(mode: ThemeMode) {\n  if (typeof window === \"undefined\") return;\n\n  const root = document.documentElement;\n  const prefersDark =\n    window.matchMedia && window.matchMedia(\"(prefers-color-scheme: dark)\").matches;\n\n  const shouldDark = mode === \"dark\" || (mode === \"system\" && prefersDark);\n\n  if (shouldDark) root.classList.add(\"dark\");\n  else root.classList.remove(\"dark\");\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;AAwBO,MAAM,eAAe;AAErB,MAAM,kBAAgC;IAC3C,OAAO;IACP,mBAAmB;IAEnB,iBAAiB;IACjB,mBAAmB;IAEnB,iBAAiB;IACjB,iBAAiB;IAEjB,sBAAsB;IACtB,mBAAmB;IAEnB,aAAa;AACf;AAEO,SAAS;IACd;;IAEA,MAAM,MAAM,OAAO,YAAY,CAAC,OAAO,CAAC;IACxC,IAAI,CAAC,KAAK,OAAO;IAEjB,IAAI;QACF,MAAM,SAAS,KAAK,KAAK,CAAC;QAC1B,OAAO;YACL,GAAG,eAAe;YAClB,GAAG,MAAM;YACT,8BAA8B;YAC9B,mBACE,OAAO,OAAO,iBAAiB,KAAK,WAChC,KAAK,GAAG,CAAC,KAAK,KAAK,GAAG,CAAC,GAAG,OAAO,iBAAiB,KAClD,gBAAgB,iBAAiB;QACzC;IACF,EAAE,OAAM;QACN,OAAO;IACT;AACF;AAEO,SAAS,aAAa,CAAe;IAC1C;;IACA,OAAO,YAAY,CAAC,OAAO,CAAC,cAAc,KAAK,SAAS,CAAC;IACzD,OAAO,aAAa,CAAC,IAAI,YAAY;AACvC;AAEO,SAAS,iBAAiB,OAAmB;IAClD;;IACA,MAAM,KAAK,IAAM;IACjB,OAAO,gBAAgB,CAAC,yBAAyB;IACjD,OAAO,gBAAgB,CAAC,WAAW;IACnC,OAAO;QACL,OAAO,mBAAmB,CAAC,yBAAyB;QACpD,OAAO,mBAAmB,CAAC,WAAW;IACxC;AACF;AAEO,SAAS,WAAW,IAAe;IACxC;;IAEA,MAAM,OAAO,SAAS,eAAe;IACrC,MAAM,cACJ,OAAO,UAAU,IAAI,OAAO,UAAU,CAAC,gCAAgC,OAAO;IAEhF,MAAM,aAAa,SAAS,UAAW,SAAS,YAAY;IAE5D,IAAI,YAAY,KAAK,SAAS,CAAC,GAAG,CAAC;SAC9B,KAAK,SAAS,CAAC,MAAM,CAAC;AAC7B"}},
    {"offset": {"line": 80, "column": 0}, "map": {"version":3,"sources":["file:///home/atlas/atlas-hitl-ui/src/app/_components/ThemeInit.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect } from \"react\";\nimport { applyTheme, loadSettings, onSettingsChange } from \"@/lib/userSettings\";\n\nexport default function ThemeInit() {\n  useEffect(() => {\n    const run = () => {\n      const s = loadSettings();\n      applyTheme(s.theme);\n    };\n\n    run();\n\n    const off = onSettingsChange(run);\n\n    // respond to system theme changes when in \"system\"\n    const mql =\n      typeof window !== \"undefined\"\n        ? window.matchMedia(\"(prefers-color-scheme: dark)\")\n        : null;\n\n    const onMql = () => run();\n\n    if (mql && mql.addEventListener) mql.addEventListener(\"change\", onMql);\n    else if (mql && (mql as any).addListener) (mql as any).addListener(onMql);\n\n    return () => {\n      off();\n      if (mql && mql.removeEventListener) mql.removeEventListener(\"change\", onMql);\n      else if (mql && (mql as any).removeListener) (mql as any).removeListener(onMql);\n    };\n  }, []);\n\n  return null;\n}\n"],"names":[],"mappings":";;;;AAEA;AACA;;AAHA;;;AAKe,SAAS;;IACtB,IAAA,0KAAS;+BAAC;YACR,MAAM;2CAAM;oBACV,MAAM,IAAI,IAAA,6IAAY;oBACtB,IAAA,2IAAU,EAAC,EAAE,KAAK;gBACpB;;YAEA;YAEA,MAAM,MAAM,IAAA,iJAAgB,EAAC;YAE7B,mDAAmD;YACnD,MAAM,MACJ,uCACI,OAAO,UAAU,CAAC,kCAClB;YAEN,MAAM;6CAAQ,IAAM;;YAEpB,IAAI,OAAO,IAAI,gBAAgB,EAAE,IAAI,gBAAgB,CAAC,UAAU;iBAC3D,IAAI,OAAO,AAAC,IAAY,WAAW,EAAE,AAAC,IAAY,WAAW,CAAC;YAEnE;uCAAO;oBACL;oBACA,IAAI,OAAO,IAAI,mBAAmB,EAAE,IAAI,mBAAmB,CAAC,UAAU;yBACjE,IAAI,OAAO,AAAC,IAAY,cAAc,EAAE,AAAC,IAAY,cAAc,CAAC;gBAC3E;;QACF;8BAAG,EAAE;IAEL,OAAO;AACT;GA9BwB;KAAA"}},
    {"offset": {"line": 131, "column": 0}, "map": {"version":3,"sources":["file:///home/atlas/atlas-hitl-ui/src/app/cases/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useMemo, useState } from \"react\";\nimport ThemeInit from \"@/app/_components/ThemeInit\";\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\";\n\ntype RiskLabel = \"ROUTINE\" | \"ESCALATE\" | \"BLOCK\";\ntype CaseStatus = \"PENDING_REVIEW\" | \"APPROVED\" | \"REJECTED\" | \"NEEDS_INFO\" | \"CLOSED\";\n\ntype CaseRecord = {\n  id: string;\n  user_name: string;\n  user_message: string;\n  tool_name: string;\n  tool_args_redacted: Record<string, unknown>;\n  risk_label: RiskLabel;\n  risk_score: number;\n  risk_rationale: string;\n  policy_refs: string[];\n  status: CaseStatus;\n  created_at: string;\n  audit_trail: Array<{\n    ts: string;\n    actor: string;\n    action: string;\n    detail?: string;\n  }>;\n};\n\nfunction cx(...parts: Array<string | false | null | undefined>) {\n  return parts.filter(Boolean).join(\" \");\n}\n\nfunction badgeClass(label: string) {\n  if (label === \"BLOCK\") return \"bg-red-600/90 text-white border-red-500/60\";\n  if (label === \"ESCALATE\") return \"bg-orange-500/90 text-white border-orange-400/60\";\n  if (label === \"APPROVED\") return \"bg-green-600/90 text-white border-green-500/60\";\n  if (label === \"REJECTED\") return \"bg-red-700/90 text-white border-red-600/60\";\n  if (label === \"PENDING_REVIEW\") return \"bg-slate-700/70 text-slate-100 border-slate-600/60\";\n  if (label === \"NEEDS_INFO\") return \"bg-yellow-500/90 text-black border-yellow-400/60\";\n  return \"bg-slate-600/60 text-slate-100 border-slate-500/60\";\n}\n\nasync function fetchCases(): Promise<CaseRecord[]> {\n  const res = await fetch(\"/api/cases\", { cache: \"no-store\" });\n  if (!res.ok) throw new Error(\"Failed to load cases\");\n  return res.json();\n}\n\nasync function decideCase(\n  id: string,\n  decision: \"APPROVE\" | \"REJECT\" | \"REQUEST_INFO\",\n  note: string\n) {\n  const res = await fetch(`/api/cases/${encodeURIComponent(id)}`, {\n    method: \"POST\",\n    headers: { \"content-type\": \"application/json\" },\n    body: JSON.stringify({ decision, note }),\n  });\n  if (!res.ok) throw new Error(\"Failed to submit decision\");\n  return res.json();\n}\n\nfunction ApproverUserMenu() {\n  const [email, setEmail] = useState(\"approver\");\n\n  useEffect(() => {\n    fetch(\"/api/auth/me\")\n      .then((r) => r.json())\n      .then((j) => setEmail(j?.session?.email ?? \"approver\"))\n      .catch(() => setEmail(\"approver\"));\n  }, []);\n\n  async function logout() {\n    await fetch(\"/api/auth/logout\", { method: \"POST\" });\n    window.location.href = \"/approver/login\";\n  }\n\n  return (\n    <DropdownMenu>\n      <DropdownMenuTrigger asChild>\n        <button className=\"inline-flex h-9 max-w-[320px] items-center justify-center truncate rounded-md border border-muted/60 bg-background/40 px-3 text-sm text-foreground shadow-sm backdrop-blur hover:bg-background/60\">\n          {email}\n        </button>\n      </DropdownMenuTrigger>\n      <DropdownMenuContent align=\"end\" className=\"w-56\">\n        <DropdownMenuLabel className=\"truncate\">{email}</DropdownMenuLabel>\n        <DropdownMenuSeparator />\n        <DropdownMenuItem asChild>\n          <a href=\"/settings\">Settings</a>\n        </DropdownMenuItem>\n        <DropdownMenuSeparator />\n        <DropdownMenuItem\n          onSelect={(e) => {\n            e.preventDefault();\n            logout();\n          }}\n        >\n          Sign out\n        </DropdownMenuItem>\n      </DropdownMenuContent>\n    </DropdownMenu>\n  );\n}\n\nexport default function CasesPage() {\n  const [all, setAll] = useState<CaseRecord[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [err, setErr] = useState<string | null>(null);\n\n  const [tab, setTab] = useState<\"PENDING\" | \"APPROVED\" | \"REJECTED\" | \"ALL\">(\"PENDING\");\n  const [q, setQ] = useState(\"\");\n  const [risk, setRisk] = useState<\"ALL\" | RiskLabel>(\"ALL\");\n\n  const [selectedId, setSelectedId] = useState<string | null>(null);\n  const [note, setNote] = useState(\"\");\n  const [busy, setBusy] = useState(false);\n\n  async function refresh() {\n    setLoading(true);\n    setErr(null);\n    try {\n      const data = await fetchCases();\n      setAll(data);\n\n      // Keep selection if still present; otherwise clear.\n      if (selectedId && !data.some((c) => c.id === selectedId)) {\n        setSelectedId(null);\n      }\n    } catch (e: any) {\n      setErr(e?.message ?? \"Unknown error\");\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  useEffect(() => {\n    refresh();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  const counts = useMemo(() => {\n    const pending = all.filter((c) => c.status === \"PENDING_REVIEW\").length;\n    const approved = all.filter((c) => c.status === \"APPROVED\").length;\n    const rejected = all.filter((c) => c.status === \"REJECTED\").length;\n    return { pending, approved, rejected, all: all.length };\n  }, [all]);\n\n  const filtered = useMemo(() => {\n    const needle = q.trim().toLowerCase();\n\n    return all\n      .filter((c) => {\n        if (tab === \"PENDING\" && c.status !== \"PENDING_REVIEW\") return false;\n        if (tab === \"APPROVED\" && c.status !== \"APPROVED\") return false;\n        if (tab === \"REJECTED\" && c.status !== \"REJECTED\") return false;\n        if (risk !== \"ALL\" && c.risk_label !== risk) return false;\n        if (!needle) return true;\n\n        const hay = [\n          c.id,\n          c.user_name,\n          c.user_message,\n          c.tool_name,\n          c.risk_label,\n          c.status,\n          c.risk_rationale,\n          (c.policy_refs ?? []).join(\" \"),\n        ]\n          .join(\" \")\n          .toLowerCase();\n\n        return hay.includes(needle);\n      })\n      .sort((a, b) => (a.created_at < b.created_at ? 1 : -1));\n  }, [all, tab, risk, q]);\n\n  const selected = useMemo(() => {\n    if (!selectedId) return null;\n    return all.find((c) => c.id === selectedId) ?? null;\n  }, [all, selectedId]);\n\n  async function onDecision(decision: \"APPROVE\" | \"REJECT\" | \"REQUEST_INFO\") {\n    if (!selected) return;\n    setBusy(true);\n    setErr(null);\n    try {\n      await decideCase(selected.id, decision, note);\n      setNote(\"\");\n      await refresh();\n    } catch (e: any) {\n      setErr(e?.message ?? \"Failed to submit decision\");\n    } finally {\n      setBusy(false);\n    }\n  }\n\n  return (\n    <div className=\"min-h-screen bg-background text-foreground\">\n      <ThemeInit />\n\n      <div className=\"mx-auto max-w-6xl px-6 py-6\">\n        <div className=\"flex items-center justify-between gap-3\">\n          <div>\n            <div className=\"text-xl font-semibold\">Cases</div>\n            <div className=\"text-sm text-muted-foreground\">\n              Review queue and decisions.\n            </div>\n          </div>\n\n          <div className=\"flex items-center gap-2\">\n            <button\n              onClick={() => refresh()}\n              className=\"h-9 rounded-md border border-muted/60 bg-background/40 px-3 text-sm shadow-sm backdrop-blur hover:bg-background/60\"\n            >\n              Refresh\n            </button>\n            <ApproverUserMenu />\n          </div>\n        </div>\n\n        {err ? (\n          <div className=\"mt-4 rounded-md border border-red-500/40 bg-red-500/10 p-3 text-sm text-red-200\">\n            {err}\n          </div>\n        ) : null}\n\n        <div className=\"mt-5 flex flex-wrap items-center gap-2\">\n          <div className=\"inline-flex rounded-md border border-muted/60 bg-background/40 p-1 backdrop-blur\">\n            <button\n              className={cx(\n                \"h-8 rounded px-3 text-sm\",\n                tab === \"PENDING\" && \"bg-foreground text-background\"\n              )}\n              onClick={() => setTab(\"PENDING\")}\n            >\n              Pending ({counts.pending})\n            </button>\n            <button\n              className={cx(\n                \"h-8 rounded px-3 text-sm\",\n                tab === \"APPROVED\" && \"bg-foreground text-background\"\n              )}\n              onClick={() => setTab(\"APPROVED\")}\n            >\n              Approved ({counts.approved})\n            </button>\n            <button\n              className={cx(\n                \"h-8 rounded px-3 text-sm\",\n                tab === \"REJECTED\" && \"bg-foreground text-background\"\n              )}\n              onClick={() => setTab(\"REJECTED\")}\n            >\n              Rejected ({counts.rejected})\n            </button>\n            <button\n              className={cx(\n                \"h-8 rounded px-3 text-sm\",\n                tab === \"ALL\" && \"bg-foreground text-background\"\n              )}\n              onClick={() => setTab(\"ALL\")}\n            >\n              All ({counts.all})\n            </button>\n          </div>\n\n          <input\n            value={q}\n            onChange={(e) => setQ(e.target.value)}\n            placeholder=\"Search id, user, tool, text, policy refs...\"\n            className=\"h-9 w-full max-w-lg rounded-md border border-muted/60 bg-background/40 px-3 text-sm outline-none backdrop-blur placeholder:text-muted-foreground focus:ring-2 focus:ring-foreground/30\"\n          />\n\n          <select\n            value={risk}\n            onChange={(e) => setRisk(e.target.value as any)}\n            className=\"h-9 rounded-md border border-muted/60 bg-background/40 px-3 text-sm backdrop-blur\"\n          >\n            <option value=\"ALL\">All risk</option>\n            <option value=\"ROUTINE\">Routine</option>\n            <option value=\"ESCALATE\">Escalate</option>\n            <option value=\"BLOCK\">Block</option>\n          </select>\n        </div>\n\n        <div className=\"mt-4 rounded-xl border border-muted/60 bg-background/40 backdrop-blur\">\n          <div className=\"overflow-x-auto\">\n            <table className=\"w-full text-sm\">\n              <thead className=\"border-b border-muted/60 text-muted-foreground\">\n                <tr>\n                  <th className=\"px-4 py-3 text-left font-medium\">Status</th>\n                  <th className=\"px-4 py-3 text-left font-medium\">Risk</th>\n                  <th className=\"px-4 py-3 text-left font-medium\">Created</th>\n                  <th className=\"px-4 py-3 text-left font-medium\">User</th>\n                  <th className=\"px-4 py-3 text-left font-medium\">Tool</th>\n                  <th className=\"px-4 py-3 text-left font-medium\">Message</th>\n                </tr>\n              </thead>\n              <tbody>\n                {loading ? (\n                  <tr>\n                    <td className=\"px-4 py-6 text-muted-foreground\" colSpan={6}>\n                      Loading...\n                    </td>\n                  </tr>\n                ) : filtered.length === 0 ? (\n                  <tr>\n                    <td className=\"px-4 py-6 text-muted-foreground\" colSpan={6}>\n                      No cases match your filters.\n                    </td>\n                  </tr>\n                ) : (\n                  filtered.map((c) => {\n                    const active = c.id === selectedId;\n                    return (\n                      <tr\n                        key={c.id}\n                        onClick={() => setSelectedId(c.id)}\n                        className={cx(\n                          \"cursor-pointer border-b border-muted/40 hover:bg-background/60\",\n                          active && \"bg-background/70\"\n                        )}\n                      >\n                        <td className=\"px-4 py-3\">\n                          <span\n                            className={cx(\n                              \"inline-flex items-center rounded-full border px-2 py-0.5 text-xs\",\n                              badgeClass(c.status)\n                            )}\n                          >\n                            {c.status}\n                          </span>\n                        </td>\n                        <td className=\"px-4 py-3\">\n                          <span\n                            className={cx(\n                              \"inline-flex items-center rounded-full border px-2 py-0.5 text-xs\",\n                              badgeClass(c.risk_label)\n                            )}\n                          >\n                            {c.risk_label} ({Math.round(c.risk_score)})\n                          </span>\n                        </td>\n                        <td className=\"px-4 py-3 text-muted-foreground\">\n                          {new Date(c.created_at).toLocaleString()}\n                        </td>\n                        <td className=\"px-4 py-3\">{c.user_name}</td>\n                        <td className=\"px-4 py-3\">{c.tool_name}</td>\n                        <td className=\"px-4 py-3 text-muted-foreground\">\n                          {c.user_message.length > 90\n                            ? c.user_message.slice(0, 90) + \"...\"\n                            : c.user_message}\n                        </td>\n                      </tr>\n                    );\n                  })\n                )}\n              </tbody>\n            </table>\n          </div>\n        </div>\n\n        {selected ? (\n          <div className=\"mt-4 rounded-xl border border-muted/60 bg-background/40 p-4 backdrop-blur\">\n            <div className=\"flex flex-wrap items-start justify-between gap-3\">\n              <div>\n                <div className=\"text-sm font-semibold\">Case details</div>\n                <div className=\"mt-1 text-xs text-muted-foreground\">\n                  ID: <span className=\"font-mono\">{selected.id}</span>\n                </div>\n              </div>\n\n              <div className=\"flex items-center gap-2\">\n                <span\n                  className={cx(\n                    \"inline-flex items-center rounded-full border px-2 py-0.5 text-xs\",\n                    badgeClass(selected.status)\n                  )}\n                >\n                  {selected.status}\n                </span>\n                <span\n                  className={cx(\n                    \"inline-flex items-center rounded-full border px-2 py-0.5 text-xs\",\n                    badgeClass(selected.risk_label)\n                  )}\n                >\n                  {selected.risk_label} ({Math.round(selected.risk_score)})\n                </span>\n              </div>\n            </div>\n\n            <div className=\"mt-4 grid gap-4 md:grid-cols-2\">\n              <div className=\"rounded-lg border border-muted/60 bg-background/30 p-3\">\n                <div className=\"text-xs font-semibold text-muted-foreground\">User message</div>\n                <pre className=\"mt-2 whitespace-pre-wrap text-sm\">{selected.user_message}</pre>\n              </div>\n\n              <div className=\"rounded-lg border border-muted/60 bg-background/30 p-3\">\n                <div className=\"text-xs font-semibold text-muted-foreground\">Risk rationale</div>\n                <pre className=\"mt-2 whitespace-pre-wrap text-sm\">{selected.risk_rationale}</pre>\n              </div>\n\n              <div className=\"rounded-lg border border-muted/60 bg-background/30 p-3\">\n                <div className=\"text-xs font-semibold text-muted-foreground\">Tool args (redacted)</div>\n                <pre className=\"mt-2 overflow-auto text-xs\">\n                  {JSON.stringify(selected.tool_args_redacted ?? {}, null, 2)}\n                </pre>\n              </div>\n\n              <div className=\"rounded-lg border border-muted/60 bg-background/30 p-3\">\n                <div className=\"text-xs font-semibold text-muted-foreground\">Policy refs</div>\n                {selected.policy_refs?.length ? (\n                  <ul className=\"mt-2 list-disc pl-5 text-sm\">\n                    {selected.policy_refs.map((p, i) => (\n                      <li key={p + \":\" + i} className=\"break-words\">\n                        {p}\n                      </li>\n                    ))}\n                  </ul>\n                ) : (\n                  <div className=\"mt-2 text-sm text-muted-foreground\">None</div>\n                )}\n              </div>\n            </div>\n\n            <div className=\"mt-4 rounded-lg border border-muted/60 bg-background/30 p-3\">\n              <div className=\"text-xs font-semibold text-muted-foreground\">Audit trail</div>\n              {selected.audit_trail?.length ? (\n                <div className=\"mt-2 space-y-2 text-sm\">\n                  {selected.audit_trail.map((a, i) => (\n                    <div key={a.ts + \":\" + i} className=\"rounded-md border border-muted/40 p-2\">\n                      <div className=\"text-xs text-muted-foreground\">\n                        {new Date(a.ts).toLocaleString()} - {a.actor} - {a.action}\n                      </div>\n                      {a.detail ? (\n                        <div className=\"mt-1 whitespace-pre-wrap text-sm\">{a.detail}</div>\n                      ) : null}\n                    </div>\n                  ))}\n                </div>\n              ) : (\n                <div className=\"mt-2 text-sm text-muted-foreground\">No audit entries.</div>\n              )}\n            </div>\n\n            <div className=\"mt-4 rounded-lg border border-muted/60 bg-background/30 p-3\">\n              <div className=\"text-xs font-semibold text-muted-foreground\">Decision note</div>\n              <textarea\n                value={note}\n                onChange={(e) => setNote(e.target.value)}\n                placeholder=\"Reasoning, next steps, or info request...\"\n                className=\"mt-2 h-24 w-full resize-y rounded-md border border-muted/60 bg-background/40 p-2 text-sm outline-none focus:ring-2 focus:ring-foreground/30\"\n              />\n\n              <div className=\"mt-3 flex flex-wrap gap-2\">\n                <button\n                  disabled={busy}\n                  onClick={() => onDecision(\"APPROVE\")}\n                  className={cx(\n                    \"h-9 rounded-md border px-3 text-sm shadow-sm\",\n                    \"border-green-500/60 bg-green-500/20 hover:bg-green-500/30\",\n                    busy && \"opacity-50\"\n                  )}\n                >\n                  Approve\n                </button>\n                <button\n                  disabled={busy}\n                  onClick={() => onDecision(\"REJECT\")}\n                  className={cx(\n                    \"h-9 rounded-md border px-3 text-sm shadow-sm\",\n                    \"border-red-500/60 bg-red-500/20 hover:bg-red-500/30\",\n                    busy && \"opacity-50\"\n                  )}\n                >\n                  Reject\n                </button>\n                <button\n                  disabled={busy}\n                  onClick={() => onDecision(\"REQUEST_INFO\")}\n                  className={cx(\n                    \"h-9 rounded-md border px-3 text-sm shadow-sm\",\n                    \"border-yellow-500/60 bg-yellow-500/20 hover:bg-yellow-500/30\",\n                    busy && \"opacity-50\"\n                  )}\n                >\n                  Request info\n                </button>\n              </div>\n            </div>\n          </div>\n        ) : (\n          <div className=\"mt-4 rounded-xl border border-muted/60 bg-background/40 p-4 text-sm text-muted-foreground backdrop-blur\">\n            Select a case to see details.\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}