{"version":3,"sources":["../../../../src/app/cases/page.tsx","../../../../src/lib/userSettings.ts","../../../../src/app/_components/ThemeInit.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useMemo, useState } from \"react\";\nimport ThemeInit from \"@/app/_components/ThemeInit\";\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\";\n\ntype RiskLabel = \"ROUTINE\" | \"ESCALATE\" | \"BLOCK\";\ntype CaseStatus = \"PENDING_REVIEW\" | \"APPROVED\" | \"REJECTED\" | \"NEEDS_INFO\" | \"CLOSED\";\n\ntype CaseRecord = {\n  id: string;\n  user_name: string;\n  user_message: string;\n  tool_name: string;\n  tool_args_redacted: Record<string, unknown>;\n  risk_label: RiskLabel;\n  risk_score: number;\n  risk_rationale: string;\n  policy_refs: string[];\n  status: CaseStatus;\n  created_at: string;\n  audit_trail: Array<{\n    ts: string;\n    actor: string;\n    action: string;\n    detail?: string;\n  }>;\n};\n\nfunction cx(...parts: Array<string | false | null | undefined>) {\n  return parts.filter(Boolean).join(\" \");\n}\n\nfunction badgeClass(label: string) {\n  if (label === \"BLOCK\") return \"bg-red-600/90 text-white border-red-500/60\";\n  if (label === \"ESCALATE\") return \"bg-orange-500/90 text-white border-orange-400/60\";\n  if (label === \"APPROVED\") return \"bg-green-600/90 text-white border-green-500/60\";\n  if (label === \"REJECTED\") return \"bg-red-700/90 text-white border-red-600/60\";\n  if (label === \"PENDING_REVIEW\") return \"bg-slate-700/70 text-slate-100 border-slate-600/60\";\n  if (label === \"NEEDS_INFO\") return \"bg-yellow-500/90 text-black border-yellow-400/60\";\n  return \"bg-slate-600/60 text-slate-100 border-slate-500/60\";\n}\n\nasync function fetchCases(): Promise<CaseRecord[]> {\n  const res = await fetch(\"/api/cases\", { cache: \"no-store\" });\n  if (!res.ok) throw new Error(\"Failed to load cases\");\n  return res.json();\n}\n\nasync function decideCase(\n  id: string,\n  decision: \"APPROVE\" | \"REJECT\" | \"REQUEST_INFO\",\n  note: string\n) {\n  const res = await fetch(`/api/cases/${encodeURIComponent(id)}`, {\n    method: \"POST\",\n    headers: { \"content-type\": \"application/json\" },\n    body: JSON.stringify({ decision, note }),\n  });\n  if (!res.ok) throw new Error(\"Failed to submit decision\");\n  return res.json();\n}\n\nfunction ApproverUserMenu() {\n  const [email, setEmail] = useState(\"approver\");\n\n  useEffect(() => {\n    fetch(\"/api/auth/me\")\n      .then((r) => r.json())\n      .then((j) => setEmail(j?.session?.email ?? \"approver\"))\n      .catch(() => setEmail(\"approver\"));\n  }, []);\n\n  async function logout() {\n    await fetch(\"/api/auth/logout\", { method: \"POST\" });\n    window.location.href = \"/approver/login\";\n  }\n\n  return (\n    <DropdownMenu>\n      <DropdownMenuTrigger asChild>\n        <button className=\"inline-flex h-9 max-w-[320px] items-center justify-center truncate rounded-md border border-muted/60 bg-background/40 px-3 text-sm text-foreground shadow-sm backdrop-blur hover:bg-background/60\">\n          {email}\n        </button>\n      </DropdownMenuTrigger>\n      <DropdownMenuContent align=\"end\" className=\"w-56\">\n        <DropdownMenuLabel className=\"truncate\">{email}</DropdownMenuLabel>\n        <DropdownMenuSeparator />\n        <DropdownMenuItem asChild>\n          <a href=\"/settings\">Settings</a>\n        </DropdownMenuItem>\n        <DropdownMenuSeparator />\n        <DropdownMenuItem\n          onSelect={(e) => {\n            e.preventDefault();\n            logout();\n          }}\n        >\n          Sign out\n        </DropdownMenuItem>\n      </DropdownMenuContent>\n    </DropdownMenu>\n  );\n}\n\nexport default function CasesPage() {\n  const [all, setAll] = useState<CaseRecord[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [err, setErr] = useState<string | null>(null);\n\n  const [tab, setTab] = useState<\"PENDING\" | \"APPROVED\" | \"REJECTED\" | \"ALL\">(\"PENDING\");\n  const [q, setQ] = useState(\"\");\n  const [risk, setRisk] = useState<\"ALL\" | RiskLabel>(\"ALL\");\n\n  const [selectedId, setSelectedId] = useState<string | null>(null);\n  const [note, setNote] = useState(\"\");\n  const [busy, setBusy] = useState(false);\n\n  async function refresh() {\n    setLoading(true);\n    setErr(null);\n    try {\n      const data = await fetchCases();\n      setAll(data);\n\n      // Keep selection if still present; otherwise clear.\n      if (selectedId && !data.some((c) => c.id === selectedId)) {\n        setSelectedId(null);\n      }\n    } catch (e: any) {\n      setErr(e?.message ?? \"Unknown error\");\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  useEffect(() => {\n    refresh();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  const counts = useMemo(() => {\n    const pending = all.filter((c) => c.status === \"PENDING_REVIEW\").length;\n    const approved = all.filter((c) => c.status === \"APPROVED\").length;\n    const rejected = all.filter((c) => c.status === \"REJECTED\").length;\n    return { pending, approved, rejected, all: all.length };\n  }, [all]);\n\n  const filtered = useMemo(() => {\n    const needle = q.trim().toLowerCase();\n\n    return all\n      .filter((c) => {\n        if (tab === \"PENDING\" && c.status !== \"PENDING_REVIEW\") return false;\n        if (tab === \"APPROVED\" && c.status !== \"APPROVED\") return false;\n        if (tab === \"REJECTED\" && c.status !== \"REJECTED\") return false;\n        if (risk !== \"ALL\" && c.risk_label !== risk) return false;\n        if (!needle) return true;\n\n        const hay = [\n          c.id,\n          c.user_name,\n          c.user_message,\n          c.tool_name,\n          c.risk_label,\n          c.status,\n          c.risk_rationale,\n          (c.policy_refs ?? []).join(\" \"),\n        ]\n          .join(\" \")\n          .toLowerCase();\n\n        return hay.includes(needle);\n      })\n      .sort((a, b) => (a.created_at < b.created_at ? 1 : -1));\n  }, [all, tab, risk, q]);\n\n  const selected = useMemo(() => {\n    if (!selectedId) return null;\n    return all.find((c) => c.id === selectedId) ?? null;\n  }, [all, selectedId]);\n\n  async function onDecision(decision: \"APPROVE\" | \"REJECT\" | \"REQUEST_INFO\") {\n    if (!selected) return;\n    setBusy(true);\n    setErr(null);\n    try {\n      await decideCase(selected.id, decision, note);\n      setNote(\"\");\n      await refresh();\n    } catch (e: any) {\n      setErr(e?.message ?? \"Failed to submit decision\");\n    } finally {\n      setBusy(false);\n    }\n  }\n\n  return (\n    <div className=\"min-h-screen bg-background text-foreground\">\n      <ThemeInit />\n\n      <div className=\"mx-auto max-w-6xl px-6 py-6\">\n        <div className=\"flex items-center justify-between gap-3\">\n          <div>\n            <div className=\"text-xl font-semibold\">Cases</div>\n            <div className=\"text-sm text-muted-foreground\">\n              Review queue and decisions.\n            </div>\n          </div>\n\n          <div className=\"flex items-center gap-2\">\n            <button\n              onClick={() => refresh()}\n              className=\"h-9 rounded-md border border-muted/60 bg-background/40 px-3 text-sm shadow-sm backdrop-blur hover:bg-background/60\"\n            >\n              Refresh\n            </button>\n            <ApproverUserMenu />\n          </div>\n        </div>\n\n        {err ? (\n          <div className=\"mt-4 rounded-md border border-red-500/40 bg-red-500/10 p-3 text-sm text-red-200\">\n            {err}\n          </div>\n        ) : null}\n\n        <div className=\"mt-5 flex flex-wrap items-center gap-2\">\n          <div className=\"inline-flex rounded-md border border-muted/60 bg-background/40 p-1 backdrop-blur\">\n            <button\n              className={cx(\n                \"h-8 rounded px-3 text-sm\",\n                tab === \"PENDING\" && \"bg-foreground text-background\"\n              )}\n              onClick={() => setTab(\"PENDING\")}\n            >\n              Pending ({counts.pending})\n            </button>\n            <button\n              className={cx(\n                \"h-8 rounded px-3 text-sm\",\n                tab === \"APPROVED\" && \"bg-foreground text-background\"\n              )}\n              onClick={() => setTab(\"APPROVED\")}\n            >\n              Approved ({counts.approved})\n            </button>\n            <button\n              className={cx(\n                \"h-8 rounded px-3 text-sm\",\n                tab === \"REJECTED\" && \"bg-foreground text-background\"\n              )}\n              onClick={() => setTab(\"REJECTED\")}\n            >\n              Rejected ({counts.rejected})\n            </button>\n            <button\n              className={cx(\n                \"h-8 rounded px-3 text-sm\",\n                tab === \"ALL\" && \"bg-foreground text-background\"\n              )}\n              onClick={() => setTab(\"ALL\")}\n            >\n              All ({counts.all})\n            </button>\n          </div>\n\n          <input\n            value={q}\n            onChange={(e) => setQ(e.target.value)}\n            placeholder=\"Search id, user, tool, text, policy refs...\"\n            className=\"h-9 w-full max-w-lg rounded-md border border-muted/60 bg-background/40 px-3 text-sm outline-none backdrop-blur placeholder:text-muted-foreground focus:ring-2 focus:ring-foreground/30\"\n          />\n\n          <select\n            value={risk}\n            onChange={(e) => setRisk(e.target.value as any)}\n            className=\"h-9 rounded-md border border-muted/60 bg-background/40 px-3 text-sm backdrop-blur\"\n          >\n            <option value=\"ALL\">All risk</option>\n            <option value=\"ROUTINE\">Routine</option>\n            <option value=\"ESCALATE\">Escalate</option>\n            <option value=\"BLOCK\">Block</option>\n          </select>\n        </div>\n\n        <div className=\"mt-4 rounded-xl border border-muted/60 bg-background/40 backdrop-blur\">\n          <div className=\"overflow-x-auto\">\n            <table className=\"w-full text-sm\">\n              <thead className=\"border-b border-muted/60 text-muted-foreground\">\n                <tr>\n                  <th className=\"px-4 py-3 text-left font-medium\">Status</th>\n                  <th className=\"px-4 py-3 text-left font-medium\">Risk</th>\n                  <th className=\"px-4 py-3 text-left font-medium\">Created</th>\n                  <th className=\"px-4 py-3 text-left font-medium\">User</th>\n                  <th className=\"px-4 py-3 text-left font-medium\">Tool</th>\n                  <th className=\"px-4 py-3 text-left font-medium\">Message</th>\n                </tr>\n              </thead>\n              <tbody>\n                {loading ? (\n                  <tr>\n                    <td className=\"px-4 py-6 text-muted-foreground\" colSpan={6}>\n                      Loading...\n                    </td>\n                  </tr>\n                ) : filtered.length === 0 ? (\n                  <tr>\n                    <td className=\"px-4 py-6 text-muted-foreground\" colSpan={6}>\n                      No cases match your filters.\n                    </td>\n                  </tr>\n                ) : (\n                  filtered.map((c) => {\n                    const active = c.id === selectedId;\n                    return (\n                      <tr\n                        key={c.id}\n                        onClick={() => setSelectedId(c.id)}\n                        className={cx(\n                          \"cursor-pointer border-b border-muted/40 hover:bg-background/60\",\n                          active && \"bg-background/70\"\n                        )}\n                      >\n                        <td className=\"px-4 py-3\">\n                          <span\n                            className={cx(\n                              \"inline-flex items-center rounded-full border px-2 py-0.5 text-xs\",\n                              badgeClass(c.status)\n                            )}\n                          >\n                            {c.status}\n                          </span>\n                        </td>\n                        <td className=\"px-4 py-3\">\n                          <span\n                            className={cx(\n                              \"inline-flex items-center rounded-full border px-2 py-0.5 text-xs\",\n                              badgeClass(c.risk_label)\n                            )}\n                          >\n                            {c.risk_label} ({Math.round(c.risk_score)})\n                          </span>\n                        </td>\n                        <td className=\"px-4 py-3 text-muted-foreground\">\n                          {new Date(c.created_at).toLocaleString()}\n                        </td>\n                        <td className=\"px-4 py-3\">{c.user_name}</td>\n                        <td className=\"px-4 py-3\">{c.tool_name}</td>\n                        <td className=\"px-4 py-3 text-muted-foreground\">\n                          {c.user_message.length > 90\n                            ? c.user_message.slice(0, 90) + \"...\"\n                            : c.user_message}\n                        </td>\n                      </tr>\n                    );\n                  })\n                )}\n              </tbody>\n            </table>\n          </div>\n        </div>\n\n        {selected ? (\n          <div className=\"mt-4 rounded-xl border border-muted/60 bg-background/40 p-4 backdrop-blur\">\n            <div className=\"flex flex-wrap items-start justify-between gap-3\">\n              <div>\n                <div className=\"text-sm font-semibold\">Case details</div>\n                <div className=\"mt-1 text-xs text-muted-foreground\">\n                  ID: <span className=\"font-mono\">{selected.id}</span>\n                </div>\n              </div>\n\n              <div className=\"flex items-center gap-2\">\n                <span\n                  className={cx(\n                    \"inline-flex items-center rounded-full border px-2 py-0.5 text-xs\",\n                    badgeClass(selected.status)\n                  )}\n                >\n                  {selected.status}\n                </span>\n                <span\n                  className={cx(\n                    \"inline-flex items-center rounded-full border px-2 py-0.5 text-xs\",\n                    badgeClass(selected.risk_label)\n                  )}\n                >\n                  {selected.risk_label} ({Math.round(selected.risk_score)})\n                </span>\n              </div>\n            </div>\n\n            <div className=\"mt-4 grid gap-4 md:grid-cols-2\">\n              <div className=\"rounded-lg border border-muted/60 bg-background/30 p-3\">\n                <div className=\"text-xs font-semibold text-muted-foreground\">User message</div>\n                <pre className=\"mt-2 whitespace-pre-wrap text-sm\">{selected.user_message}</pre>\n              </div>\n\n              <div className=\"rounded-lg border border-muted/60 bg-background/30 p-3\">\n                <div className=\"text-xs font-semibold text-muted-foreground\">Risk rationale</div>\n                <pre className=\"mt-2 whitespace-pre-wrap text-sm\">{selected.risk_rationale}</pre>\n              </div>\n\n              <div className=\"rounded-lg border border-muted/60 bg-background/30 p-3\">\n                <div className=\"text-xs font-semibold text-muted-foreground\">Tool args (redacted)</div>\n                <pre className=\"mt-2 overflow-auto text-xs\">\n                  {JSON.stringify(selected.tool_args_redacted ?? {}, null, 2)}\n                </pre>\n              </div>\n\n              <div className=\"rounded-lg border border-muted/60 bg-background/30 p-3\">\n                <div className=\"text-xs font-semibold text-muted-foreground\">Policy refs</div>\n                {selected.policy_refs?.length ? (\n                  <ul className=\"mt-2 list-disc pl-5 text-sm\">\n                    {selected.policy_refs.map((p, i) => (\n                      <li key={p + \":\" + i} className=\"break-words\">\n                        {p}\n                      </li>\n                    ))}\n                  </ul>\n                ) : (\n                  <div className=\"mt-2 text-sm text-muted-foreground\">None</div>\n                )}\n              </div>\n            </div>\n\n            <div className=\"mt-4 rounded-lg border border-muted/60 bg-background/30 p-3\">\n              <div className=\"text-xs font-semibold text-muted-foreground\">Audit trail</div>\n              {selected.audit_trail?.length ? (\n                <div className=\"mt-2 space-y-2 text-sm\">\n                  {selected.audit_trail.map((a, i) => (\n                    <div key={a.ts + \":\" + i} className=\"rounded-md border border-muted/40 p-2\">\n                      <div className=\"text-xs text-muted-foreground\">\n                        {new Date(a.ts).toLocaleString()} - {a.actor} - {a.action}\n                      </div>\n                      {a.detail ? (\n                        <div className=\"mt-1 whitespace-pre-wrap text-sm\">{a.detail}</div>\n                      ) : null}\n                    </div>\n                  ))}\n                </div>\n              ) : (\n                <div className=\"mt-2 text-sm text-muted-foreground\">No audit entries.</div>\n              )}\n            </div>\n\n            <div className=\"mt-4 rounded-lg border border-muted/60 bg-background/30 p-3\">\n              <div className=\"text-xs font-semibold text-muted-foreground\">Decision note</div>\n              <textarea\n                value={note}\n                onChange={(e) => setNote(e.target.value)}\n                placeholder=\"Reasoning, next steps, or info request...\"\n                className=\"mt-2 h-24 w-full resize-y rounded-md border border-muted/60 bg-background/40 p-2 text-sm outline-none focus:ring-2 focus:ring-foreground/30\"\n              />\n\n              <div className=\"mt-3 flex flex-wrap gap-2\">\n                <button\n                  disabled={busy}\n                  onClick={() => onDecision(\"APPROVE\")}\n                  className={cx(\n                    \"h-9 rounded-md border px-3 text-sm shadow-sm\",\n                    \"border-green-500/60 bg-green-500/20 hover:bg-green-500/30\",\n                    busy && \"opacity-50\"\n                  )}\n                >\n                  Approve\n                </button>\n                <button\n                  disabled={busy}\n                  onClick={() => onDecision(\"REJECT\")}\n                  className={cx(\n                    \"h-9 rounded-md border px-3 text-sm shadow-sm\",\n                    \"border-red-500/60 bg-red-500/20 hover:bg-red-500/30\",\n                    busy && \"opacity-50\"\n                  )}\n                >\n                  Reject\n                </button>\n                <button\n                  disabled={busy}\n                  onClick={() => onDecision(\"REQUEST_INFO\")}\n                  className={cx(\n                    \"h-9 rounded-md border px-3 text-sm shadow-sm\",\n                    \"border-yellow-500/60 bg-yellow-500/20 hover:bg-yellow-500/30\",\n                    busy && \"opacity-50\"\n                  )}\n                >\n                  Request info\n                </button>\n              </div>\n            </div>\n          </div>\n        ) : (\n          <div className=\"mt-4 rounded-xl border border-muted/60 bg-background/40 p-4 text-sm text-muted-foreground backdrop-blur\">\n            Select a case to see details.\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n","export type ThemeMode = \"system\" | \"light\" | \"dark\";\nexport type InboxTab = \"PENDING\" | \"APPROVED\" | \"REJECTED\" | \"ALL\";\nexport type RiskFilter = \"ALL\" | \"ROUTINE\" | \"ESCALATE\" | \"BLOCK\";\nexport type PreviewBehavior = \"open_on_click\" | \"auto_on_select\";\nexport type PreviewPosition = \"right_rail\" | \"modal_drawer\";\nexport type NoteRequirement = \"off\" | \"block_only\" | \"high_only\" | \"block_or_high\";\nexport type AutoRefresh = \"off\" | \"30s\" | \"60s\";\n\nexport type UserSettings = {\n  theme: ThemeMode;\n  keyboardShortcuts: boolean;\n\n  defaultInboxTab: InboxTab;\n  defaultRiskFilter: RiskFilter;\n\n  previewBehavior: PreviewBehavior;\n  previewPosition: PreviewPosition;\n\n  decisionRequiresNote: NoteRequirement;\n  highRiskThreshold: number; // used when decisionRequiresNote involves high risk\n\n  autoRefresh: AutoRefresh;\n};\n\nexport const SETTINGS_KEY = \"atlas_user_settings_v1\";\n\nexport const defaultSettings: UserSettings = {\n  theme: \"system\",\n  keyboardShortcuts: true,\n\n  defaultInboxTab: \"PENDING\",\n  defaultRiskFilter: \"ALL\",\n\n  previewBehavior: \"open_on_click\",\n  previewPosition: \"right_rail\",\n\n  decisionRequiresNote: \"off\",\n  highRiskThreshold: 80,\n\n  autoRefresh: \"off\",\n};\n\nexport function loadSettings(): UserSettings {\n  if (typeof window === \"undefined\") return defaultSettings;\n\n  const raw = window.localStorage.getItem(SETTINGS_KEY);\n  if (!raw) return defaultSettings;\n\n  try {\n    const parsed = JSON.parse(raw) as Partial<UserSettings>;\n    return {\n      ...defaultSettings,\n      ...parsed,\n      // safety: keep threshold sane\n      highRiskThreshold:\n        typeof parsed.highRiskThreshold === \"number\"\n          ? Math.min(100, Math.max(0, parsed.highRiskThreshold))\n          : defaultSettings.highRiskThreshold,\n    };\n  } catch {\n    return defaultSettings;\n  }\n}\n\nexport function saveSettings(s: UserSettings) {\n  if (typeof window === \"undefined\") return;\n  window.localStorage.setItem(SETTINGS_KEY, JSON.stringify(s));\n  window.dispatchEvent(new CustomEvent(\"atlas_settings_change\"));\n}\n\nexport function onSettingsChange(handler: () => void) {\n  if (typeof window === \"undefined\") return () => {};\n  const fn = () => handler();\n  window.addEventListener(\"atlas_settings_change\", fn);\n  window.addEventListener(\"storage\", fn);\n  return () => {\n    window.removeEventListener(\"atlas_settings_change\", fn);\n    window.removeEventListener(\"storage\", fn);\n  };\n}\n\nexport function applyTheme(mode: ThemeMode) {\n  if (typeof window === \"undefined\") return;\n\n  const root = document.documentElement;\n  const prefersDark =\n    window.matchMedia && window.matchMedia(\"(prefers-color-scheme: dark)\").matches;\n\n  const shouldDark = mode === \"dark\" || (mode === \"system\" && prefersDark);\n\n  if (shouldDark) root.classList.add(\"dark\");\n  else root.classList.remove(\"dark\");\n}\n","\"use client\";\n\nimport { useEffect } from \"react\";\nimport { applyTheme, loadSettings, onSettingsChange } from \"@/lib/userSettings\";\n\nexport default function ThemeInit() {\n  useEffect(() => {\n    const run = () => {\n      const s = loadSettings();\n      applyTheme(s.theme);\n    };\n\n    run();\n\n    const off = onSettingsChange(run);\n\n    // respond to system theme changes when in \"system\"\n    const mql =\n      typeof window !== \"undefined\"\n        ? window.matchMedia(\"(prefers-color-scheme: dark)\")\n        : null;\n\n    const onMql = () => run();\n\n    if (mql && mql.addEventListener) mql.addEventListener(\"change\", onMql);\n    else if (mql && (mql as any).addListener) (mql as any).addListener(onMql);\n\n    return () => {\n      off();\n      if (mql && mql.removeEventListener) mql.removeEventListener(\"change\", onMql);\n      else if (mql && (mql as any).removeListener) (mql as any).removeListener(onMql);\n    };\n  }, []);\n\n  return null;\n}\n"],"names":[],"mappings":"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"}